device:
  name: "Hoymiles Inverter (Extracted Mapping)"
  manufacturer: "Hoymiles"
  model: "Modbus (text extract)"

entities:
  # ------------------------------------------------------------
  # [Battery Charge/Discharge Parameters]
  # ------------------------------------------------------------

  - platform: number
    key: battery_max_charge_power
    name: "Battery Max Charge Power"
    unit: "%"
    minimum: 10
    maximum: 100
    description: "Battery maximum charge power rate"
    read:
      type: holding
      address: 306
      data_type: uint16
    write:
      type: holding
      address: 306
      data_type: uint16

  - platform: number
    key: battery_max_discharge_power
    name: "Battery Max Discharge Power"
    unit: "%"
    minimum: 10
    maximum: 100
    description: "Battery maximum discharge power rate"
    read:
      type: holding
      address: 307
      data_type: uint16
    write:
      type: holding
      address: 307
      data_type: uint16

  - platform: number
    key: max_soc
    name: "Max SOC"
    unit: "%"
    minimum: 10
    maximum: 100
    description: "Battery maximum charge SOC"
    read:
      type: holding
      address: 308
      data_type: uint16
    write:
      type: holding
      address: 308
      data_type: uint16

  - platform: number
    key: min_soc
    name: "Min SOC"
    unit: "%"
    minimum: 10
    maximum: 90
    description: "Battery maximum Discharge SOC"
    read:
      type: holding
      address: 309
      data_type: uint16
    write:
      type: holding
      address: 309
      data_type: uint16

  - platform: number
    key: battery_capacity
    name: "Battery Capacity"
    unit: "Ah"
    description: "Battery capacity"
    read:
      type: holding
      address: 4102
      data_type: uint16
      scale: 0.1
    write:
      type: holding
      address: 4102
      data_type: uint16
      scale: 0.1

  - platform: number
    key: max_charge_current
    name: "Max Charge Current"
    unit: "A"
    description: "Maximum charging current"
    read:
      type: holding
      address: 4103
      data_type: uint16
      scale: 0.1
    write:
      type: holding
      address: 4103
      data_type: uint16
      scale: 0.1

  - platform: number
    key: max_discharge_current
    name: "Max Discharge Current"
    unit: "A"
    description: "Maximum discharge current"
    read:
      type: holding
      address: 4104
      data_type: uint16
      scale: 0.1
    write:
      type: holding
      address: 4104
      data_type: uint16
      scale: 0.1

  # ------------------------------------------------------------
  # [Inverter EMS Parameters]
  # ------------------------------------------------------------

  - platform: select
    key: ems_mode
    name: "Ems Mode"
    values:
      0: "Self-Use"
      1: "Economical Mode"
      2: "Backup Mode"
      3: "Pure Off-Grid Mode"
      4: "Force Charge Mode"
      5: "Force Discharge Mode"
      6: "Peak-shaving Mode"
      7: "TOU Mode"
    read:
      type: holding
      address: 4300
      data_type: uint16
    write:
      type: holding
      address: 4300
      data_type: uint16

  - platform: number
    key: self_used_soc
    name: "Self-Used SOC"
    unit: "%"
    minimum: 10
    maximum: 100
    description: "Reserved SOC in self-use mode"
    read:
      type: holding
      address: 4301
      data_type: uint16
    write:
      type: holding
      address: 4301
      data_type: uint16

  - platform: number
    key: backup_soc
    name: "Back-up SOC"
    unit: "%"
    minimum: 60
    maximum: 100
    description: "Reserved SOC in back-up mode"
    read:
      type: holding
      address: 4302
      data_type: uint16
    write:
      type: holding
      address: 4302
      data_type: uint16

  - platform: number
    key: force_charge_soc
    name: "Force Charge SOC"
    unit: "%"
    minimum: 10
    maximum: 100
    description: "Max SOC in force charge mode"
    read:
      type: holding
      address: 4303
      data_type: uint16
    write:
      type: holding
      address: 4303
      data_type: uint16

  - platform: number
    key: maximum_charge_power
    name: "Maximum Charge Power"
    unit: "%"
    description: "Maximum charge power rate"
    read:
      type: holding
      address: 4304
      data_type: uint16
      scale: 0.1
    write:
      type: holding
      address: 4304
      data_type: uint16
      scale: 0.1

  - platform: number
    key: force_disarge_soc
    name: "Force Disarge SOC"
    unit: "%"
    description: "Max SOC in force discharge mode"
    read:
      type: holding
      address: 4305
      data_type: uint16
    write:
      type: holding
      address: 4305
      data_type: uint16

  - platform: number
    key: maximum_discharge_power
    name: "Maximum Discharge Power"
    unit: "%"
    description: "Maximum discharge power rate"
    read:
      type: holding
      address: 4306
      data_type: uint16
      scale: 0.1
    write:
      type: holding
      address: 4306
      data_type: uint16
      scale: 0.1

  - platform: number
    key: economic_mode_soc
    name: "Economic Mode SOC"
    unit: "%"
    description: "Reserved SOC in economic mode"
    read:
      type: holding
      address: 4307
      data_type: uint16
    write:
      type: holding
      address: 4307
      data_type: uint16

  - platform: number
    key: tou_mode_reserved_soc
    name: "TOU Mode Reserved SOC"
    unit: "%"
    minimum: 10
    maximum: 100
    read:
      type: holding
      address: 4545
      data_type: uint16
    write:
      type: holding
      address: 4545
      data_type: uint16
